<%
  cache(:id => @manifestation.id, :action => :show, :controller => :manifestations, :action_suffix => 'show_holding', :editable => @manifestation.is_updatable_by(current_user), :locale => @locale, :version => @version) do
    %>
<table style="width: 100%">
  <tr>
    <th><%= t('activerecord.models.library') -%></th>
    <th><%= t('activerecord.models.shelf') -%></th>
    <th><%= t('activerecord.attributes.item.call_number') -%></th>
    <th><%= t('activerecord.attributes.item.item_identifier') -%></th>
    <th><%= t('activerecord.models.circulation_status') -%></th>
  </tr>
  <%- for item in manifestation.items.on_shelf -%>
    <tr>
      <td>
        <%= link_to h(item.shelf.library.display_name.localize), library_path(item.shelf.library.name)%>
      </td>
      <td>
        <%= link_to h(item.shelf.display_name.localize), shelf_path(item.shelf) -%>
        <%= render :partial => 'items/shelf_picture', :locals => {:item => item} -%>
      </td>
      <td>
        <%= item.call_number -%>
      </td>
      <td>
        <%- unless item.item_identifier.blank? -%>
          <%= link_to h(item.item_identifier), item -%>
        <%- else -%>
          (<%= link_to t('item.no_number'), item -%>)
        <%- end -%>
      </td>
      <td>
        <%= item.circulation_status.display_name.localize if item.circulation_status -%>
        <%- if item.rent? -%>
          (
            <%= t('activerecord.attributes.checkout.due_date') -%>:
            <%= l(item.checkouts.first.due_date, :format => :short) -%>
          )
        <%- end -%>
      </td>
    </tr>
  <%- end -%>
</table>
<%- end -%>

<%- if request.xhr? -%>
  <script type="text/javascript" language="JavaScript">
    jQuery(document).ready(function(){
      tb_init('a.thickbox, area.thickbox, input.thickbox');
      imgLoader = new Image();
      imgLoader.src = tb_pathToImage;
    });
  </script>
<%- end -%>
