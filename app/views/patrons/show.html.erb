<div id="submenu">
  <%- if @patron.is_updatable_by(current_user) -%>
    <ul>
      <%- if User.is_creatable_by(current_user) -%>
        <%- if @patron.user.blank? -%>
          <li><%= link_to t('patron.activate_as_user'), new_user_path(:patron_id => @patron.id) -%></li>
        <%- else -%>
          <li><%= link_to t('patron.deactivate'), edit_user_path(@patron.user.login) -%></li>
        <%- end -%>
      <%- end -%>
      <li><%= link_to t('page.add_picture'), new_patron_picture_file_path(@patron) -%></li>
      <li><%= link_to t('page.edit'), edit_patron_path(@patron) -%></li>
      <li><%= link_to t('page.back'), patrons_path -%></li>
      <%- if @patron.is_deletable_by(current_user) -%>
        <li><%= link_to t('page.new', :model => t('activerecord.models.patron')), new_patron_path -%></li>
        <li><%= link_to t('page.destroy'), @patron, :confirm => t('page.are_you_sure'), :method => :delete -%></li>
      <%- end -%>
    </ul>
  <%- end -%>
  <ul>
    <li><%= link_to t('page.listing', :model => t('activerecord.models.work')), patron_works_path(@patron) -%></li>
  </ul>
  <ul>
    <li><%= link_to t('page.listing', :model => t('activerecord.models.expression')), patron_expressions_path(@patron) -%></li>
  </ul>
  <ul>
    <li><%= link_to t('page.listing', :model => t('activerecord.models.manifestation')), patron_manifestations_path(@patron) -%></li>
  </ul>
</div>

<div id="content_detail">
<h1 class="title"><%= t('page.showing', :model => t('activerecord.models.patron')) -%></h1>
<div id="content_list">
  <%-
    cache(:id => @patron.id, :editable => @patron.is_updatable_by(current_user)) do
  -%>
  <h2 id="resource_title">
    [P]
    <%=h @patron.full_name -%>
  </h2>

  <p>
    (<%= link_to_wikipedia(@patron.full_name_without_space) -%>)
    <%- if !@patron.user && User.is_creatable_by(current_user)-%>
      (<%= link_to t('patron.activate_as_user'), new_user_path(:patron_id => @patron.id) -%>)
    <%- end -%>
  </p>

<div id="tabview">

  <div id="demo" class="yui-navset yui-navset-top">
    <ul class="yui-nav">
      <li title="active" class="selected"><a href="#detail"><em><%= t('page.detail') -%></em></a></li>
      <%- unless @patron.works.empty? -%>
        <li><a href="#work"><em><%= t('activerecord.models.work') -%></em></a></li>
      <%- end -%>
      <%- unless @patron.expressions.empty? -%>
        <li><a href="#expression"><em><%= t('activerecord.models.expression') -%></em></a></li>
      <%- end -%>
      <%- unless @patron.manifestations.empty? -%>
        <li><a href="#manifestation"><em><%= t('activerecord.models.manifestation') -%></em></a></li>
      <%- end -%>
    </ul>
    <div class="yui-content">
      <div id="detail">
        <table id="index">
          <tr>
            <td><b><%= t('activerecord.attributes.patron.full_name') -%>:</b></td>
            <td><%=h @patron.full_name -%></td>
          </tr>
          <tr>
            <td><b><%= t('activerecord.attributes.patron.full_name_transcription') -%>:</b></td>
            <td><%=h @patron.full_name_transcription -%></td>
          </tr>
          <%- if @patron.user -%>
            <tr>
              <td><b><%= t('activerecord.attributes.user.login') -%>:</b></td>
              <td><%= link_to h(@patron.user.login), edit_user_path(@patron.user.login) -%></td>
            </tr>
          <%- end -%>
          <tr>
            <td><b><%= t('activerecord.models.patron_type') -%>:</b></td>
            <td><%=h @patron.patron_type.display_name -%></td>
          </tr>
          <tr>
            <td><b><%= t('activerecord.attributes.patron.other_designation') -%>:</b></td>
            <td><%=h @patron.other_designation -%></td>
          </tr>
          <tr>
            <td><b><%= t('activerecord.attributes.patron.place') -%>:</b></td>
            <td><%=h @patron.place -%></td>
          </tr>
          <tr>
            <td><b><%= t('page.language') -%>:</b></td>
            <td><%=h @patron.language.display_name -%></td>
          </tr>
          <%- if deletable(@patron) -%>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.zip_code_1') -%>:</b></td>
              <td><%=h @patron.zip_code_1 -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.address_1') -%>:</b></td>
              <td><%=h @patron.address_1 -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.telephone_number_1') -%>:</b></td>
              <td><%=h @patron.telephone_number_1 -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.fax_number_1') -%>:</b></td>
              <td><%=h @patron.fax_number_1 -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.address_1_note') -%>:</b></td>
              <td><%=h @patron.address_1_note -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.zip_code_2') -%>:</b></td>
              <td><%=h @patron.zip_code_2 -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.address_2') -%>:</b></td>
              <td><%=h @patron.address_2 -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.telephone_number_2') -%>:</b></td>
              <td><%=h @patron.telephone_number_2 -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.fax_number_2') -%>:</b></td>
              <td><%=h @patron.fax_number_2 -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.address_2_note') -%>:</b></td>
              <td><%=h @patron.address_2_note -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.date_of_birth') -%>:</b></td>
              <td><%=h @patron.date_of_birth -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.patron.date_of_death') -%>:</b></td>
              <td><%=h @patron.date_of_death -%></td>
            </tr>
          <%- end -%>
          <tr>
            <td><b><%= t('activerecord.attributes.patron.note') -%>:</b></td>
            <td><%=h @patron.note -%></td>
          </tr>
          <tr>
            <td><b><%= t('page.created_at') -%>:</b></td>
            <td><%= l(@patron.created_at) -%></td>
          </tr>
          <tr>
            <td><b><%= t('page.updated_at') -%>:</b></td>
            <td><%= l(@patron.updated_at) -%></td>
          </tr>
        </table>
      </div>
      <%- unless @works.blank? -%>
        <%= render :partial => 'patrons/work_list', :locals => {:works => @works} -%>
      <%- end -%>
      <%- unless @expressions.blank? -%>
        <%= render :partial => 'patrons/expression_list', :locals => {:expressions => @expressions} -%>
      <%- end -%>
      <%- unless @manifestations.blank? -%>
        <%= render :partial => 'patrons/manifestation_list', :locals => {:manifestations => @manifestations} -%>
      <%- end -%>
    </div>
  </div>
</div>
<%= render :partial => 'page/tabview' -%>
</div>
<%- end -%>
</div>
