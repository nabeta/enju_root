<div class="header_and_footer">
  <%- cache(:controller => 'library_groups', :id => LibraryGroup.site_config.id, :action_suffix => 'header', :locale => @locale, :role => current_user.try(:highest_role).try(:name)) do -%>
    <div id="header_left">
      <h2><a href="/" title="<%= LibraryGroup.site_config.display_name.localize -%>"><%= LibraryGroup.site_config.display_name.localize -%></a></h2>
    </div>
  <%- end -%>

  <%= render :partial => 'advertisements/header' -%>
  <%= render :partial => 'page/select_locale' -%>

  <div id="header_right">
    <%- if user_signed_in? -%>
      <%- cache :controller => 'users', :action => 'show', :id => current_user.username, :locale => @locale do -%>
        <%= t('page.logged_in_as', :login_name => current_user.username) -%>
        <br />
        <%= link_to t('page.account'), edit_user_path(current_user.username) -%>
        <%= link_to t('page.logout'), destroy_user_session_path -%>
      <%- end -%>
    <%- else -%>
      <%= link_to t('page.login'), new_user_session_path -%>
      <%- unless controller.controller_name == 'users' and controller.action_name == 'new' -%>
        (<%= link_to t('user.sign_up'), new_user_registration_path -%>)
      <%- end -%>
    <%- end -%>
  </div>
</div>
