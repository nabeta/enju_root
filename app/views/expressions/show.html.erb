<%= render :partial => 'page/tabview' -%>

<div id="submenu">
  <ul>
  <%- case when @work -%>
    <li><%= link_to t('page.listing', :model => t('activerecord.models.expression')), work_expressions_path(@work) -%></li>
  <%- when @patron -%>
    <li><%= link_to t('page.listing', :model => t('activerecord.models.expression')), patron_expressions_path(@patron) -%></li>
  <%- else -%>
    <li><%= link_to t('page.listing', :model => t('activerecord.models.expression')), expressions_path -%></li>
  <%- end -%>
  </ul>
  <ul>
    <%- if @expression.is_deletable_by(current_user) -%>
      <li><%= link_to t('page.new', :model => t('activerecord.models.expression')), new_expression_path -%></li>
      <li><%= link_to t('page.edit'), edit_expression_path(@expression) -%></li>
      <li><%= link_to t('page.destroy'), @expression, :confirm => t('page.are_you_sure'), :method => :delete -%></li>
    <%- end -%>
    <%- if @expression.serial? -%>
      <li><%= link_to t('page.listing', :model => t('activerecord.models.subscription')), expression_subscriptions_path(@expression) -%></li>
    <%- else -%>
      <li></li>
    <%- end -%>
  </ul>
  <ul>
    <li><%= link_to t('page.listing', :model => t('activerecord.models.patron')), expression_patrons_path(@expression) -%></li>
    <li><%= link_to t('page.listing', :model => t('activerecord.models.manifestation')), expression_manifestations_path(@expression) -%></li>
    <%- if @expression.serial? -%>
      <%- if Manifestation.is_creatable_by(current_user) -%>
        <li><%= link_to t('manifestation.add_next_issue'), new_expression_manifestation_path(@expression) -%></li>
      <%- end -%>
    <%- end -%>
  </ul>
</div>
<div id="content_detail">
<h1 class="title"><%= t('page.showing', :model => t('activerecord.models.expression')) -%></h1>
<div id="content_list">
  <%-
    cache(:id => @expression.id, :action => :show, :controller => :expressions, :editable => @expression.is_updatable_by(current_user), :locale => @locale) do
  -%>
  <h2 id="resource_title">
    [E]
    <%=h @expression.original_title -%>
    <%= expression_form_icon(@expression.expression_form) -%>
  </h2>

  <p>
    <%= patrons_list(@expression.work.patrons) -%>
    <%= patrons_list(@expression.patrons) -%>
  </p>
<div id="tabview">

  <div id="demo" class="yui-navset yui-navset-top">
    <ul class="yui-nav">
      <li title="active" class="selected"><a href="#detail"><em><%= t('activerecord.models.expression') -%></em></a></li>
      <%- unless @expression.patrons.empty? -%>
        <li><a href="#patron"><em><%= t('activerecord.models.patron') -%></em></a></li>
      <%- end -%>
      <li><a href="#work"><em><%= t('page.related_work') -%></em></a></li>
      <li><a href="#manifestation"><em><%= t('page.related_manifestation') -%></em></a></li>
    </ul>
    <div class="yui-content">
      <div id="detail">
        <table id="index">
          <tr>
            <td><b><%= t('activerecord.attributes.expression.title_transcription') -%>:</b></td>
            <td><%=h @expression.title_transcription -%></td>
          </tr>
          <tr>
            <td><b><%= t('activerecord.attributes.expression.summarization') -%>:</b></td>
            <td><%=h @expression.summarization -%></td>
          </tr>
          <tr>
            <td><b><%= t('activerecord.attributes.expression.context') -%>:</b></td>
            <td><%=h @expression.context -%></td>
          </tr>
          <tr>
            <td><b><%= t('activerecord.models.language') -%>:</b></td>
            <td><%=h @expression.language.display_name.localize -%></td>
          </tr>
          <tr>
            <td><b><%= t('activerecord.models.expression_form') -%>:</b></td>
            <td>
              <%= expression_form_icon(@expression.expression_form) -%>
              <%=h @expression.expression_form.display_name.localize -%>
            </td>
          </tr>
          <%- if @expression.serial? -%>
            <tr>
              <td><b><%= t('activerecord.models.frequency_of_issue') -%>:</b></td>
              <td><%=h @expression.frequency_of_issue.display_name.localize -%></td>
            </tr>
            <tr>
              <td><b><%= t('activerecord.attributes.expression.issn') -%>:</b></td>
              <td><%=h @expression.issn -%></td>
            </tr>
          <%- end -%>
          <tr>
            <td><b><%= t('activerecord.attributes.expression.feed_url') -%>:</b></td>
            <td><%=h @expression.feed_url -%></td>
          </tr>
          <tr>
            <td><b><%= t('activerecord.attributes.expression.note') -%>:</b></td>
            <td><%=h @expression.note -%></td>
          </tr>
          <tr>
            <td><b><%= t('page.created_at') -%>:</b></td>
            <td><%= l(@expression.created_at) -%></td>
          </tr>
          <tr>
            <td><b><%= t('page.updated_at') -%>:</b></td>
            <td><%= l(@expression.updated_at) -%></td>
          </tr>
        </table>
      </div>
      <%- unless @expression.patrons.empty? -%>
        <%= render :partial => 'expressions/patron_list' -%>
      <%- end -%>
      <%- if @expression.work -%>
        <%= render :partial => 'expressions/work_list' -%>
      <%- end -%>
      <%- if @expression.work -%>
        <%= render :partial => 'expressions/manifestation_list' -%>
      <%- end -%>
    </div>
  </div>
</div>
<%= render :partial => 'page/tabview' -%>
<%- end -%>
</div>
</div>
