<div id="content_detail">
<h1 class="title"><%= t('activerecord.models.message') -%></h1>
<div id="content_list">
<%- form_for :messages, :url => user_messages_path(current_user.username), :html => {:method => 'get'} do -%>
  <p>
    <%= t('page.search_term') -%>: <%= text_field_tag 'query', h(@query), {:id => 'search_form_top', :class => 'search_form'} -%>
    <%= submit_tag t('page.search') -%>
   </p>
  <%= javascript_tag("$('#search_form_top').focus()") -%>
<%- end -%>

<%- form_for :message, :url => destroy_selected_user_messages_path do |form| -%>
  <table class="index">
    <tr>
      <th></th>
      <th><%= t('activerecord.models.subject') -%></th>
      <th><%= rezm_sender_or_receiver_label -%></th>
      <th><%= t('message.sent_at') -%></th>
    </tr>
  <%- for message in @messages  -%>
    <tr class="line<%= cycle("0", "1") -%>">
      <td><%= rezm_delete_check_box(message) -%></td>
      <td><%= rezm_link_to_message(message) -%></td>
      <td><%= rezm_sender_or_receiver(message) -%></td>
      <td><%= l(message.created_at) -%></td>  
    </tr>
  <%- end -%>
    <tr>
      <td colspan="4"><%= submit_tag t('message.delete') -%></td>
    </tr>
  </table>
<%- end -%>
<%= will_paginate(@messages) -%>
</div>
</div>

<div id="submenu">
  <ul>
    <li><%= rezm_link_to_inbox -%></li>
    <%- if current_user.has_role?('Librarian') -%>
      <li><%= rezm_link_to_create_message -%></li>
      <li><%= rezm_link_to_outbox -%></li>
    <%- end -%>
    <li><%= rezm_link_to_trash_bin -%></li>
  </ul>
</div>
